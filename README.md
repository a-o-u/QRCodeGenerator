# QR Code  Generator
A python program to generate QR codes from Google Sheets document and IFC files.

## Installation
### Install prerequisites
You need to have python installed.

#### On Mac
Using Homebrew, in terminal:

    brew install pythonx.x
    brew install virtualenv

    
#### On Windows
Example for Windows when not using any package management software and limited or no admin rights: - Install python using the Anaconda distribution in the Arup software shop or following: https://conda.io/projects/conda/en/latest/user-guide/install/index.html - Make sure you select 'add to path' when prompted by the installation wizard. If you failed to select 'add to path' during the installation: Go to Control Panel - User Accounts - Change my environment variables. Under User variables find 'Path' and click 'Edit'. Then click new and paste the path to where the conda distribution was installed - the path can be found by opening Anaconda prompt and running the following command:

    echo %PATH%
Miniconda and Anaconda come with virtual environment management so you can choose to ignore the virtualenv installation above. 


When the virtual environment is active you can install the required python packeges using the following on the command line:

    pip install -r requirements.txt
    
In order to be able to use IFC as input file you will need to install the python package **IfcOpenShell**. You can find the appropriate version of this module here: http://ifcopenshell.org/python. Download the  module and place the extracted archive in the site-packages folder of your Python distribution.


## Configuration
This program allows you to generate the QR code both from a Google Sheets document and IFC files. 
You can set your input parameters (e.g. input files, output folder, etc etc) in the `config_def.py` file which you can find in the `config` folder. 

### Generate QR code from Google Sheets
You will need to edit the `config_def.py` by adding the 

        SPREADSHEET_ID = 'spreadsheet_id'
        WORKSHEET = 'sheet_name'
        CREDENTIAL_FILE_PATH = 'path_to_creds.json'
        OUTPUT = 'path_to_output_folder'


The spreadsheet MUST follow the following structure:


| asset_guid | assed_name | size | 
| -------- | ---- | ------- |

in which `size` refers to the size  of the QR code. 
By default it has been considered a size of 10, however the following options have been also implemented:
    
    small = 5
    medium = 10
    large = 15

An example of input file can be found here (git https://docs.google.com/spreadsheets/d/1O0-xqhXqkBIxdCF81NNyP5_yEINe75wXKkW12d54ApI/edit?usp=sharing)

To run the script use the following command line:

    python gsheet2qrcode.py


### Generate QR code from IFC file
You will need to edit the `config_def.py` by adding the 

        IFC_FILE_PATH = 'path_to_ifc_file'
        OUTPUT = 'path_to_output_folder'


The asset name can be specified in the IFC file under the **Data** property definition. If it's not provided, the name will be generated by following the BDNS naming convention (if possible) using the Revit Tag number. 

 
To run the script use the following command line:

    python ifc2qrcode.py
    
    
### Validation agaist Building Device Naming Standards (BDNS) 
Three validation tests can be run by enabling the following flag in the `config_def.py`

    BDNS_VALIDATION = True

1. Check the device instance globally unique identifier (GUID) format and its uniqueness 

2. Check that the device name rule is fulfilled 

3. Check if the abbreviation used is compliant with the BDSN Abbreviations Register (https://github.com/theodi/BDNS/blob/master/BDNS_Abbreviations_Register.csv)


These tests are in place for warning purpose.

More details on the BDNS initiative can be found here (https://github.com/theodi/BDNS)



 
